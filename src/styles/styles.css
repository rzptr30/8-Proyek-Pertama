/* Reset ringan + preferensi fokus yang jelas */
*,
*::before,
*::after { box-sizing: border-box; }
html, body { margin: 0; padding: 0; }
:root { color-scheme: light dark; }
body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', sans-serif;
  line-height: 1.6;
  background: Canvas;
  color: CanvasText;
}

/* Screen-reader only utility */
.sr-only {
  position: absolute !important;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0,0,0,0);
  white-space: nowrap; border: 0;
}

/* Skip link */
.skip-link {
  position: absolute;
  top: -40px;
  left: 8px;
  background: #0a84ff;
  color: #fff;
  padding: 8px 12px;
  border-radius: 6px;
  text-decoration: none;
  transition: top .2s;
  z-index: 1000;
}
.skip-link:focus { top: 8px; }

/* Header */
.main-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 16px;
  border-bottom: 1px solid color-mix(in srgb, CanvasText 20%, transparent);
}
.brand-name {
  font-weight: 700;
  text-decoration: none;
  color: inherit;
}
.navigation-drawer { display: block; }
.navigation-drawer.open { outline: 2px solid #0a84ff; }
.nav-list {
  display: flex;
  gap: 12px;
  list-style: none;
  margin: 0;
  padding: 0;
}
.nav-list a {
  display: inline-block;
  padding: 6px 10px;
  border-radius: 6px;
  color: inherit;
  text-decoration: none;
}
.nav-list a:hover { background: color-mix(in srgb, CanvasText 10%, transparent); }
.nav-list a.active, .nav-list a[aria-current="page"] {
  background: color-mix(in srgb, #0a84ff 25%, transparent);
  color: color-mix(in srgb, #0a84ff 10%, CanvasText);
}

/* Drawer button (mobile) */
.drawer-button {
  font-size: 20px;
  padding: 6px 10px;
  display: none; /* aktif pada layar kecil */
}

/* Main */
.main-content {
  padding: 16px;
  min-height: 65vh;
  outline: none;
}

/* Footer */
.site-footer {
  padding: 16px;
  border-top: 1px solid color-mix(in srgb, CanvasText 20%, transparent);
  font-size: 14px;
}

/* Halaman */
.page-title { margin-top: 0; }

/* Fallback transition classes */
.fade-out { opacity: 0; transition: opacity .12s ease-out; }
.fade-in { opacity: 1; transition: opacity .2s ease-in; }

/* View Transitions API custom: geser + fade */
::view-transition-old(root) {
  animation: slide-out .22s ease-in both;
}
::view-transition-new(root) {
  animation: slide-in .22s ease-out both;
}
@keyframes slide-in {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes slide-out {
  from { opacity: 1; transform: translateY(0); }
  to   { opacity: 0; transform: translateY(-8px); }
}

/* Aksesibilitas: fokus yang jelas */
:where(a, button, input, textarea, select, [tabindex]):focus-visible {
  outline: 3px solid #0a84ff;
  outline-offset: 2px;
  border-radius: 6px;
}

/* Preferensi Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
}

/* Notice */
.notice {
  padding: 12px 14px;
  border-radius: 8px;
  background: color-mix(in srgb, CanvasText 8%, transparent);
}
.notice--error {
  border: 1px solid color-mix(in srgb, red 40%, transparent);
  background: color-mix(in srgb, red 12%, transparent);
}

/* Card list (Beranda) */
.card-list {
  display: grid;
  grid-template-columns: repeat(12, 1fr);
  gap: 16px;
}
.card {
  grid-column: span 4;
  display: flex;
  flex-direction: column;
  background: color-mix(in srgb, CanvasText 6%, transparent);
  border: 1px solid color-mix(in srgb, CanvasText 14%, transparent);
  border-radius: 12px;
  overflow: clip;
  min-height: 100%;
}
.card__media-link { display: block; line-height: 0; }
.card__media {
  width: 100%;
  height: 180px;
  object-fit: cover;
  background: color-mix(in srgb, CanvasText 8%, transparent);
}
.card__body { padding: 12px; }
.card__title { margin: 0 0 6px 0; font-size: 1.05rem; }
.card__title a { color: inherit; text-decoration: none; }
.card__title a:hover { text-decoration: underline; }
.card__desc { margin: 0 0 8px 0; color: color-mix(in srgb, CanvasText 20%, CanvasText); }
.card__meta { margin: 0; font-size: .9rem; color: color-mix(in srgb, CanvasText 35%, CanvasText); }

/* Skeleton */
.card--skeleton .card__media,
.skeleton-block {
  background: linear-gradient(90deg,
    color-mix(in srgb, CanvasText 6%, transparent) 25%,
    color-mix(in srgb, CanvasText 14%, transparent) 37%,
    color-mix(in srgb, CanvasText 6%, transparent) 63%
  );
  background-size: 400% 100%;
  animation: shimmer 1.2s ease-in-out infinite;
  height: 180px;
}
.skeleton-line {
  height: 12px;
  border-radius: 6px;
  margin: 8px 0;
  background: linear-gradient(90deg,
    color-mix(in srgb, CanvasText 6%, transparent) 25%,
    color-mix(in srgb, CanvasText 14%, transparent) 37%,
    color-mix(in srgb, CanvasText 6%, transparent) 63%
  );
  background-size: 400% 100%;
  animation: shimmer 1.2s ease-in-out infinite;
}
@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Map layout (Halaman Peta) */
.map-layout {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 16px;
  align-items: start;
}
.map-layout__map {
  height: 520px;
  border-radius: 12px;
  overflow: clip;
  border: 1px solid color-mix(in srgb, CanvasText 14%, transparent);
}
.map-layout__list {
  border: 1px solid color-mix(in srgb, CanvasText 14%, transparent);
  border-radius: 12px;
  overflow: clip;
  background: color-mix(in srgb, CanvasText 6%, transparent);
}
.map-layout__list-head {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  padding: 10px 12px;
  border-bottom: 1px solid color-mix(in srgb, CanvasText 14%, transparent);
}
.map-layout__list-body {
  max-height: 520px;
  overflow: auto;
  padding: 8px 8px 12px;
}
.status-text { font-size: .9rem; color: color-mix(in srgb, CanvasText 40%, CanvasText); }
.status--error { color: #b00020; }
.status--success { color: #0a7d19; }

/* Map list items */
.maplist { list-style: none; margin: 0; padding: 0; }
.maplist__item { margin: 4px; }
.maplist__btn {
  width: 100%;
  text-align: left;
  border: 1px solid transparent;
  background: transparent;
  color: inherit;
  padding: 10px 10px;
  border-radius: 10px;
  cursor: pointer;
}
.maplist__btn:hover { background: color-mix(in srgb, CanvasText 10%, transparent); }
.maplist__item.is-active .maplist__btn {
  border-color: #0a84ff;
  background: color-mix(in srgb, #0a84ff 20%, transparent);
}
.maplist__title { display: block; font-weight: 600; }
.maplist__desc { display: block; font-size: .9rem; color: color-mix(in srgb, CanvasText 35%, CanvasText); }

/* Popup */
.leaflet-popup-content { margin: 8px 10px; }
.popup { display: grid; grid-template-columns: 64px 1fr; gap: 8px; align-items: start; }
.popup__media img { width: 64px; height: 64px; object-fit: cover; border-radius: 6px; display: block; }
.popup__body { font-size: .95rem; }

/* Add page */
.add-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
}
.add-layout__map {
  height: 400px;
  border: 1px solid color-mix(in srgb, CanvasText 14%, transparent);
  border-radius: 12px;
  overflow: clip;
}
.add-form {
  display: grid;
  gap: 12px;
}
.form-field label { display: block; font-weight: 600; margin-bottom: 6px; }
.form-field input[type="text"],
.form-field input[type="url"],
.form-field input[type="file"],
.form-field textarea {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid color-mix(in srgb, CanvasText 20%, transparent);
  border-radius: 8px;
  background: color-mix(in srgb, CanvasText 6%, transparent);
  color: inherit;
}
.field-hint { display: block; font-size: .9rem; color: color-mix(in srgb, CanvasText 40%, CanvasText); }
.latlon { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.preview img {
  max-width: 100%;
  height: auto;
  display: block;
  margin-top: 8px;
  border-radius: 8px;
  border: 1px solid color-mix(in srgb, CanvasText 14%, transparent);
}
.form-actions { display: flex; gap: 8px; }
button {
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid color-mix(in srgb, CanvasText 20%, transparent);
  background: color-mix(in srgb, CanvasText 8%, transparent);
  color: inherit;
  cursor: pointer;
}
button:hover { background: color-mix(in srgb, CanvasText 12%, transparent); }

/* Camera panel */
.camera-panel summary { cursor: pointer; }
.camera-panel__body { display: grid; gap: 10px; margin-top: 8px; }
#camera-video {
  width: 100%;
  max-height: 260px;
  background: color-mix(in srgb, CanvasText 8%, transparent);
  border-radius: 8px;
}
.camera-actions { display: flex; gap: 8px; }

/* Responsif */
@media (min-width: 1024px) {
  .add-layout { grid-template-columns: 1.3fr 1fr; align-items: start; }
  .add-layout__map { height: 520px; }
}
@media (max-width: 1024px) {
  .card { grid-column: span 6; }
}
@media (max-width: 768px) {
  .drawer-button { display: inline-block; }
  .nav-list { display: none; }
  .navigation-drawer.open .nav-list { display: flex; flex-direction: column; }
  .card { grid-column: span 12; }

  .map-layout { grid-template-columns: 1fr; }
  .map-layout__map { height: 380px; }
  .map-layout__list-body { max-height: 300px; }
  .latlon { grid-template-columns: 1fr; }
}
/* Optimasi untuk layar kecil ~375px */
@media (max-width: 400px) {
  .main-header { gap: 8px; padding: 10px 12px; }
  .brand-name { font-size: 1rem; }
  .drawer-button { padding: 4px 8px; }
  .main-content { padding: 12px; }
  .card__media { height: 160px; }
}